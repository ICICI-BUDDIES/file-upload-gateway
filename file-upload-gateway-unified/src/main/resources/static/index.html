<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Upload Gateway</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header class="icici-header">
        <div class="icici-header-inner">

            <!-- LEFT SECTION -->
            <div class="header-left">
                <a href="https://www.icicibank.com/" target="_blank" rel="noopener noreferrer">
                    <img class="icici-logo" src="ICICI_HeaderLogo (1).png" alt="Organiser banner logo" />
                </a>
                <span class="app-name">File Upload Gateway</span>
            </div>

            <!-- RIGHT SECTION -->
            <div class="header-right">

                <!-- 1800 1080 phone -->
                <div class="support-block">
                    <img src="Frame 1410086205-3.png" alt="Support Phone" onclick="handlePhoneClick()" style="cursor: pointer;" title="Call or Copy: 1800 108 010" />
                </div>

                <!-- iPal Icon -->
                <!-- <div class="ipal">
                    <img src="icons8-topic 1-2.png" alt="iPal" />
                </div> -->

                <!-- Country Selector -->
                <div class="country-select">
                    <select id="countrySelect" onchange="changeCountry(this.value)">
                        <option value="india-en">ЁЯЗоЁЯЗ│ INDIA (ENGLISH)</option>
                        <option value="india-hi">ЁЯЗоЁЯЗ│ INDIA (рд╣рд┐рдВрджреА)</option>
                        <option value="bahrain">ЁЯЗзЁЯЗн BAHRAIN</option>
                        <option value="canada">ЁЯЗиЁЯЗж CANADA</option>
                        <option value="china">ЁЯЗиЁЯЗ│ CHINA</option>
                        <option value="germany">ЁЯЗйЁЯЗк GERMANY</option>
                        <option value="hongkong">ЁЯЗнЁЯЗ░ HONG KONG</option>
                        <option value="singapore">ЁЯЗ╕ЁЯЗм SINGAPORE</option>
                        <option value="uk">ЁЯЗмЁЯЗз UNITED KINGDOM</option>
                        <option value="usa">ЁЯЗ║ЁЯЗ╕ UNITED STATES</option>
                        <option value="uae">ЁЯЗжЁЯЗк DIFC-UAE</option>
                        <option value="europe">ЁЯЗкЁЯЗ║ EUROPE</option>
                    </select>
                </div>

                <!-- Login Button -->
                <!-- <div class="login-btn">
                    <img src="New Button Set.png" alt="Login" onclick="loginAction()" />
                </div> -->

            </div>
        </div>
    </header>

    <main class="container">
        <div class="card">
            <!-- Step 1: Select Template Display Name and File Type -->
            <section class="selection-section">
                <h2>Select Template</h2>
                <div class="dropdown-row">
                    <div class="field-group">
                        <label for="categorySelect">Template Display Name <span style="color: red;">*</span></label>
                        <select id="categorySelect">
                            <option value="">Select Template</option>
                        </select>
                    </div>
                </div>
                <div id="selectionError" class="error-message"></div>
            </section>

            <!-- Step 2: Template Preview and Download -->
            <section id="templateSection" class="template-section" style="display: none;">
                <div class="template-header">
                    <h2>Template Preview</h2>
                    <button id="downloadBtn" class="btn btn-download">Download Template</button>
                </div>
                <div class="template-info">
                    <div class="template-details">
                        <div id="templateName" class="template-name"></div>
                        <div id="headerPreview" class="header-preview"></div>
                    </div>
                </div>
                <div id="downloadStatus" class="status-message"></div>
            </section>

            <!-- Step 3: Upload File -->
            <section class="upload-section">
                <h2>Upload File</h2>
                <div class="upload-area">
                    <div class="field-group">
                        <label for="fileInput">Select File <span style="color: red;">*</span></label>
                        <div class="file-upload-row">
                            <input type="file" id="fileInput" accept=".csv,.xls,.xlsx,.txt">
                            <button id="uploadBtn" class="btn btn-upload" disabled>Upload File</button>
                        </div>
                    </div>
                </div>
                <div id="uploadStatus" class="status-message"></div>
            </section>
        </div>
    </main>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script>
        // Extract appName from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const appNameHash = urlParams.get('app');

        if (!appNameHash) {
            document.body.innerHTML = '<div style="text-align: center; margin-top: 2rem; color: #dc3545;"><h2>Error: Missing app parameter</h2><p>This utility must be called with an app parameter.</p></div>';
        }

        // Handle phone click - dial on mobile, copy on desktop
        function handlePhoneClick() {
            const phoneNumber = '1800 108 010';
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                window.location.href = 'tel:+911800108010';
            } else {
                navigator.clipboard.writeText(phoneNumber).then(() => {
                    showToast('Phone number copied to clipboard: ' + phoneNumber, 'success');
                }).catch(() => {
                    showToast('Phone number: ' + phoneNumber, 'info');
                });
            }
        }

        // Show toast notification
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast toast-${type} toast-show`;
            
            setTimeout(() => {
                toast.className = 'toast';
            }, 3000);
        }

        // Translation data
        const translations = {
            en: {
                appName: 'File Upload Gateway',
                selectTemplate: 'Select Template',
                category: 'Template Display Name',
                selectCategory: 'Select Template',
                templatePreview: 'Template Preview',
                downloadTemplate: 'Download Template',
                uploadFile: 'Upload File',
                selectFile: 'Select File',
                uploadFileBtn: 'Upload File'
            },
            hi: {
                appName: 'рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдЧреЗрдЯрд╡реЗ',
                selectTemplate: 'рдЯреЗрдореНрдкрд▓реЗрдЯ рдЪреБрдиреЗрдВ',
                category: 'рдЯреЗрдореНрдкрд▓реЗрдЯ рдкреНрд░рджрд░реНрд╢рди рдирд╛рдо',
                selectCategory: 'рдЯреЗрдореНрдкрд▓реЗрдЯ рдЪреБрдиреЗрдВ',
                templatePreview: 'рдЯреЗрдореНрдкрд▓реЗрдЯ рдкреВрд░реНрд╡рд╛рд╡рд▓реЛрдХрди',
                downloadTemplate: 'рдЯреЗрдореНрдкрд▓реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ',
                uploadFile: 'рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ',
                selectFile: 'рдлрд╛рдЗрд▓ рдЪреБрдиреЗрдВ',
                uploadFileBtn: 'рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ'
            }
        };

        // Change country and language function
        function changeCountry(country) {
            let lang = 'en';
            
            if (country === 'india-hi') {
                lang = 'hi';
            } else {
                lang = 'en';
            }
            
            const t = translations[lang];
            if (!t) return;

            document.querySelector('.app-name').textContent = t.appName;
            document.querySelector('.selection-section h2').textContent = t.selectTemplate;
            document.querySelector('label[for="categorySelect"]').innerHTML = t.category + ' <span style="color: red;">*</span>';
            document.querySelector('#categorySelect option[value=""]').textContent = t.selectCategory;
            document.querySelector('.template-section h2').textContent = t.templatePreview;
            document.querySelector('#downloadBtn').textContent = t.downloadTemplate;
            document.querySelector('.upload-section h2').textContent = t.uploadFile;
            document.querySelector('label[for="fileInput"]').innerHTML = t.selectFile + ' <span style="color: red;">*</span>';
            document.querySelector('#uploadBtn').textContent = t.uploadFileBtn;

            document.documentElement.lang = lang;
            localStorage.setItem('selectedCountry', country);
            
            // Force chevron back to default after selection
            document.getElementById('countrySelect').blur();
        }

        // Load saved country on page load
        window.addEventListener('DOMContentLoaded', () => {
            const savedCountry = localStorage.getItem('selectedCountry') || 'india-en';
            document.getElementById('countrySelect').value = savedCountry;
            changeCountry(savedCountry);
        });
    </script>
    <script src="script.js"></script>
    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>
</body>

</html>